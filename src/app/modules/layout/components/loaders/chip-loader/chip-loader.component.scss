$hue: 153;
$primary1: hsl($hue, 90%, 90%);
$primary3: hsl($hue, 90%, 70%);
$primary7: hsl($hue, 90%, 30%);
$primary9: hsl($hue, 90%, 10%);
$trans-dur: 0.3s;

:host {
  font-size: clamp(1rem, 0.8rem + 1vw, 2rem);

  * {
    border: 0;
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    background-color: $primary9;
    color: $primary1;
    display: flex;
    font: 1em/1.5 sans-serif;
    height: 100vh;
    transition: background-color $trans-dur, color $trans-dur;
  }

  .microchip {
    display: block;
    margin: auto;
    width: 8em;
    height: auto;

    &__center,
    &__dot,
    &__line,
    &__lines,
    &__spark,
    &__wave {
      animation-duration: 5s;
      animation-timing-function: cubic-bezier(0.65, 0, 0.35, 1);
      animation-iteration-count: infinite;
    }

    &__core,
    &__dot {
      fill: $primary7;
      transition: fill $trans-dur;
    }

    &__center,
    &__wave {
      transform-origin: 25px 25px;
    }

    &__center {
      animation-name: center-scale;
    }

    @for $i from 1 through 9 {
      &__dot--#{$i} {
        animation-name: dot-scale#{$i};
        transform-origin: if(
          $i == 1,
          3px 38px,
          if(
            $i == 2,
            3px 54px,
            if(
              $i == 3,
              3px 70px,
              if(
                $i == 4,
                3px 3px,
                if($i == 5, 20px 3px, if($i == 6, 3px 30px, if($i == 7, 37px 3px, if($i == 8, 54px 3px, 71px 3px))))
              )
            )
          )
        );
      }
    }

    &__line,
    &__spark,
    &__wave {
      transition: stroke $trans-dur;
    }

    &__line {
      stroke: $primary7;

      @for $i from 1 through 9 {
        &--#{$i} {
          animation-name: line-draw#{$i};
        }
      }
    }

    &__lines {
      animation-name: lines-scale;
      transform-origin: 54px 54px;
    }

    &__spark,
    &__wave {
      animation-timing-function: linear;
      stroke: $primary3;

      @for $i from 1 through 9 {
        &--#{$i} {
          animation-name: spark#{$i};
        }
      }
    }

    &__wave--1 {
      animation-name: wave-scale1;
    }

    &__wave--2 {
      animation-name: wave-scale2;
    }
  }
}

@keyframes center-scale {
  from,
  to {
    transform: scale(0);
  }
  12.5%,
  75% {
    transform: scale(1);
  }
}

@for $i from 1 through 9 {
  @keyframes dot-scale#{$i} {
    @if $i == 2 {
      from,
      10.5%,
      87.5%,
      to {
        transform: scale(0);
      }
      23%,
      75% {
        transform: scale(1);
      }
    } @else if $i == 5 {
      from,
      11.5%,
      87.5%,
      to {
        transform: scale(0);
      }
      24%,
      75% {
        transform: scale(1);
      }
    } @else if $i == 6 {
      from,
      14.5%,
      85%,
      to {
        transform: scale(0);
      }
      27%,
      72.5% {
        transform: scale(1);
      }
    } @else if $i == 8 {
      from,
      11%,
      87.5%,
      to {
        transform: scale(0);
      }
      23.5%,
      75% {
        transform: scale(1);
      }
    } @else {
      from,
      20%,
      81.25%,
      to {
        transform: scale(0);
      }
      32.5%,
      68.75% {
        transform: scale(1);
      }
    }
  }

  @keyframes line-draw#{$i} {
    from,
    93.75%,
    to {
      stroke-dashoffset: if($i == 2, 42, if($i == 4, 78, if($i == 5, 60, if($i == 6, 91, if($i == 8, 43, 60)))));
    }
    25%,
    68.75% {
      stroke-dashoffset: if($i == 2 or $i == 5 or $i == 8, 0, if($i == 4, 18, if($i == 6, 31, 17)));
    }
  }

  @keyframes spark#{$i} {
    from,
    27.5% {
      stroke-dashoffset: if($i == 2, 42, if($i == 4, 78, if($i == 5, 60, if($i == 6, 91, if($i == 8, 43, 60)))));
    }
    50%,
    52.5% {
      stroke-dashoffset: if($i == 2, -42, if($i == 4, -42, if($i == 5, -60, if($i == 6, -29, if($i == 8, -43, -26)))));
    }
    75%,
    to {
      stroke-dashoffset: if(
        $i == 2,
        -126,
        if($i == 4, -162, if($i == 5, -180, if($i == 6, -149, if($i == 8, -129, -112))))
      );
    }
  }
}

@keyframes lines-scale {
  from {
    opacity: 1;
    transform: scale(0);
  }
  12.5%,
  75% {
    opacity: 1;
    transform: scale(1);
  }
  93.75%,
  to {
    opacity: 0;
    transform: scale(0.5);
  }
}

@keyframes wave-scale1 {
  from,
  0%,
  25%,
  50%,
  75% {
    stroke-width: 6px;
    transform: scale(1);
  }
  10%,
  35%,
  60%,
  85%,
  to {
    animation-timing-function: steps(1);
    stroke-width: 0;
    transform: scale(2);
  }
}

@keyframes wave-scale2 {
  from,
  5%,
  30%,
  55%,
  80% {
    stroke-width: 6px;
    transform: scale(1);
  }
  15%,
  40%,
  65%,
  90%,
  to {
    animation-timing-function: steps(1);
    stroke-width: 0;
    transform: scale(2);
  }
}
